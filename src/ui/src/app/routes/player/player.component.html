<div id="player">
  <app-video-player [videoUrl]="currentVideo.url | safeVideoUrl"></app-video-player>

  <div id="filters">
    <app-dropdown-filters [animeId]="animeId" [episode]="episode" column="language" placeholder="Язык"
                          (change)="filter.language = ($event !== 'Язык' ?  $event :  null)"></app-dropdown-filters>
    <app-dropdown-filters [animeId]="animeId" [episode]="episode" column="author" placeholder="Студия"
                          (change)="filter.author = ($event !== 'Студия' ?  $event :  null)"></app-dropdown-filters>
    <app-dropdown-filters [animeId]="animeId" [episode]="episode" column="quality" placeholder="Качество"
                          (change)="filter.quality = ($event !== 'Качество' ?  $event :  null)"></app-dropdown-filters>
  </div>

  <div id="controls">
    <div class="control-box">
      <button class="mdc-button" (click)="changeEpisode(+episode - 1)">
        <i class="material-icons md-24">fast_rewind</i>
      </button>
      <div class="control-box-subtext">Предыдущий</div>
    </div>
    <div>
      <input id="shikicinema-episode" class="mdc-text-field__input" [(ngModel)]="episode"
             (ngModelChange)="changeEpisode(episode)" value="1">
      <div class="control-box-subtext">
        (<a [href]="currentVideo.url" target="_blank" class="shc-links">прямая ссылка</a>)
      </div>
    </div>
    <div class="control-box">
      <button class="mdc-button" (click)="changeEpisode(+episode + 1)">
        <i class="material-icons md-24">fast_forward</i>
      </button>
      <div class="control-box-subtext">Следующий</div>
    </div>
    <div class="control-box"
          [title]="isSynced ? 'Отметить как просмотренную' : 'Синхронизироваться с Шикимори'"
          (click)="isSynced ? markAsWatched(episode) : synchronize() ">
      <button class="mdc-button" [class.watched]="watched(episode)">
        <i class="material-icons md-24">{{ isSynced ? 'done' : 'sync' }}</i>
      </button>
      <div class="control-box-subtext">{{ isSynced ? 'Просмотрено' : 'Шикимори' }}</div>
    </div>
    <div class="control-box" [title]="isSynced ? 'Загрузить видео' : 'Требуется авторизация на Шикимори'">
      <button class="mdc-button" [disabled]="!isSynced">
        <i class="material-icons md-24">add</i>
      </button>
      <div class="control-box-subtext">Загрузить</div>
    </div>
  </div>

  <div id="series">
    <app-episodes-list [animeId]="animeId" (change)="changeEpisode($event)"></app-episodes-list>
    <app-video-list [videos]="videos
                                    | filterBy:['language']:filter.language
                                    | filterBy:['author']:filter.author
                                    | filterBy:['quality']:filter.quality"
            (change)="changeVideo($event)"></app-video-list>
  </div>
</div>

<app-server-status></app-server-status>
<app-uploader [uploadedByUser]="currentVideo.uploader"></app-uploader>
